<!DOCTYPE html>
<html  lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1"><meta name="viewport" content="width=device-width, initial-scale=1" />

      <title>03.モニタリングとイベント管理_グリッドテーブル</title>
    
          <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
          <link rel="stylesheet" href="_static/theme.css " type="text/css" />
      
      <!-- sphinx script_files -->
        <script src="_static/documentation_options.js?v=144c8c96"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/translations.js?v=4dbe4bdc"></script>

      
      <!-- bundled in js (rollup iife) -->
      <!-- <script src="_static/theme-vendors.js"></script> -->
      <script src="_static/theme.js" defer></script>
    
  <link rel="index" title="索引" href="genindex.html" />
  <link rel="search" title="検索" href="search.html" />
  <link rel="next" title="04.サービスデスク" href="04-00-00.html" />
  <link rel="prev" title="02.サービス運用方針" href="02-00-00.html" /> 
  </head>

  <body>
    <div id="app">
    <div class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="index.html" class="home-link">
    
      <span class="site-name">CARNAS &amp;g Service</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">クイック検索</span>
    <div class="searchformwrapper">
      <form class="search" action="search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="検索" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="index.html#carnas-g">carnas &g サービス運用設計書</a></span>
      </p>
      <ul class="current">
        
          <li class="toctree-l1 ">
            
              <a href="00-00-00.html" class="reference internal ">表紙</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="00-00-01.html" class="reference internal ">改訂履歴</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="00-00-02.html" class="reference internal ">はじめに</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="01-00-00.html" class="reference internal ">01.運用設計方針</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="02-00-00.html" class="reference internal ">02.サービス運用方針</a>
            

            
          </li>

        
          <li class="toctree-l1 current">
            
              <a href="#" class="reference internal current">03.モニタリングとイベント管理_グリッドテーブル</a>
            

            
              <ul>
                
                  <li class="toctree-l2"><a href="#id1" class="reference internal">03.モニタリングとイベント管理_グリッドテーブル</a></li>
                
              </ul>
            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="04-00-00.html" class="reference internal ">04.サービスデスク</a>
            

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
    
    <li>03.モニタリングとイベント管理_グリッドテーブル</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="02-00-00.html"
       title="前の章へ">← 02.サービス運用方針</a>
  </li>
  <li class="next">
    <a href="04-00-00.html"
       title="次の章へ">04.サービスデスク →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main" v-pre>
            
  <section id="id1">
<h1>03.モニタリングとイベント管理_グリッドテーブル<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h1>
<p>3.1 概要</p>
<blockquote>
<div><p>監視システム（Datadog/CloudWatch）を用いて24時間365日監視し、イベント発生時には、速やかに所定の連絡先へ連絡する。</p>
</div></blockquote>
<p>3.2 担当者</p>
<blockquote>
<div><p>モニタリングとイベント管理の担当は「運用担当」とする。</p>
</div></blockquote>
<p>3.3 体制</p>
<blockquote>
<div><p>イベント管理の体制および連絡経路については、下図の通りとする。</p>
</div></blockquote>
<img alt="" src="image0011.gif" >
<p>3.4 業務フロー</p>
<img alt="" src="image0022.gif" >
<p>3.5 監視（イベント管理）の対象範囲</p>
<blockquote>
<div><p>監視対象は下記の通りとする。</p>
</div></blockquote>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>環境</p></td>
<td><p>対象</p></td>
<td><p>モニタリング</p></td>
<td><p>外形監視</p></td>
<td><p>概要説明</p></td>
</tr>
<tr class="row-even"><td rowspan="5"><p>CARNAS g サービス</p></td>
<td><p>AWSサービス(各インフラ)</p></td>
<td><p>〇</p></td>
<td><p>x</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>業務サイト</p></td>
<td><p>〇</p></td>
<td><p>〇</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>テナント解説申し込みサイト</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>契約サポートサイト</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>管理サイト</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Web予約サービス</p></td>
<td><p>Web予約サービス</p></td>
<td><p>x</p></td>
<td><p>〇</p></td>
<td><p>バックエンドのみ対象。フロントエンドはDynax社が実施</p></td>
</tr>
<tr class="row-even"><td rowspan="4"><p>検診機関ネットワーク</p></td>
<td><p>エッジサーバー</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td><p>ログインログ、イベントログのみS3に出力する通信ログは、取得しない</p></td>
</tr>
<tr class="row-odd"><td><p>中継ポイント</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>連携システム(医事DB)</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>クライアントPC(Excel編集アプリ)</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td></td>
</tr>
<tr class="row-even"><td rowspan="3"><p>外部Saasサービス</p></td>
<td><p>認証サービス(Auth0)</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>メール配信サービス(SendGrid)</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>モニタリングサービス(Datadog)</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>3.6 監視（イベント管理）の項目</p>
<blockquote>
<div><p>監視項目の一覧は、以下とする。　※当面はDatadogは使わずCloudWatchで行う</p>
</div></blockquote>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>監視項目</p></td>
<td><p>内容</p></td>
</tr>
<tr class="row-even"><td><p>運用担当向け（Datadog）</p></td>
<td></td>
</tr>
<tr class="row-odd"><td rowspan="4"><p>サービス稼働状況</p></td>
<td rowspan="4"><p>SLO達成率（年）、月間稼働率（月）</p>
<p>サービス単位稼働率（月／年）</p>
<p>　対象：bff bff-ex business core pub</p>
<p>　　engin-file engin-pdf engin-file-billing engin-pdf-billing</p>
</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="4"><p>データーベース稼働状況 DB全体の年間稼働率（年）、DB全体の月間稼働率（月）</p></td>
<td rowspan="4"><p>サービス単位稼働率（月／年）</p>
<p>　対象：business core pub report</p>
<p>AWSサービス単位稼働率（月／年）</p>
<p>　対象：ElasticCache OpenSearch</p>
</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td><p>その他稼働率</p></td>
<td><p>フロントALB（月／年）、バックエンドALB（月／年）</p></td>
</tr>
<tr class="row-even"><td><p>イベント インシデント</p></td>
<td><p>Issue list、AWS Cloudwatchログ（警告、エラー）、datadog側のイベント、AWS Cloudwatchログ（サマリ）</p></td>
</tr>
<tr class="row-odd"><td><p>リソース状態</p></td>
<td><p>EC2,ECS,RDS,container,forgateの各CPU、メモリー、ネットワーク利用状況、モニターサマリー</p></td>
</tr>
<tr class="row-even"><td><p>アクセス数  PV等</p></td>
<td><p>ALBリクエスト回数、ALBアクティブコネクション</p></td>
</tr>
<tr class="row-odd"><td><p>DBストレージの使用量状況</p></td>
<td><p>Aurora ElasticSearch</p></td>
</tr>
<tr class="row-even"><td><p>オブジェクトストレージの使用量状況</p></td>
<td><p>S3 Bucket Cloudwatch Logs</p></td>
</tr>
<tr class="row-odd"><td><p>開発担当向け（Datadog）</p></td>
<td></td>
</tr>
<tr class="row-even"><td rowspan="5"><p>フロントエンドの状況</p>
<p>（ALBの主要なログ分析）</p>
</td>
<td rowspan="5"><p>HTTPエラーログ／タイムアウトログ</p>
<p>WAFのブロックログ</p>
<p>HTTPエラー集計</p>
<p>時間のかかっているエンドポイント</p>
<p>アクセス数の多いエンドポイント</p>
</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>バックエンドの状況</p>
<p>（アプリやECS関連の主要メトリクスやログ）</p>
</td>
<td rowspan="2"><p>ECS CPU、メモリ使用率、ECS CPU、メモリ使用率（サービス毎）</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="4"><p>ECS/forgate関連の主要なグラフやリスト（CPU使用率、メモリ空き容量、IO回数やデータ量、スケールアウト状況）</p></td>
<td rowspan="4"><p>forgate CPU、メモリ使用率（コンテナ毎）</p>
<p>forgete READ/WRITE回数・バイト数（コンテナ毎）</p>
<p>ECSイベント一覧</p>
<p>ECSサービス稼働率</p>
</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="3"><p>バックエンドエンドステータスの状況</p>
<p>（AuroraやECS、SQS、Redisの主要なメトリクス）</p>
</td>
<td rowspan="3"><p>postgresクエリ数、応答時間、クエリヒット数</p>
<p>redisクエリ数、応答時間、クエリヒット数</p>
<p>SQS送受信メッセージ数</p>
</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
</tbody>
</table>
<p>3.7 モニタリングのよる異常検知</p>
<blockquote>
<div><p>実行中のモニタリングを、下記に示す。　※当面はDatadogは使わずCloudWatchで行う</p>
</div></blockquote>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>モニター種別</p></td>
<td><p>モニター名</p></td>
<td><p>概要</p></td>
<td><p>対象メトリクス</p></td>
<td><p>アラート</p></td>
<td><p>ワーニング</p></td>
<td><p>復旧</p></td>
</tr>
<tr class="row-even"><td rowspan="10"><p>死活エラー</p></td>
<td rowspan="2"><p>[CARNAS &amp;g] RDS DB接続数</p></td>
<td rowspan="2"><p>RDS DB接続数</p>
<p>接続数が0の場合、異常と判断</p>
</td>
<td rowspan="2"><p>aws.rds.database_connections</p></td>
<td rowspan="2"><p>接続数=0</p></td>
<td rowspan="2"><p>接続数=2</p></td>
<td rowspan="2"><p>接続数=2以上</p></td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="2"><p>[CARNAS &amp;g] RDS スループット（送信）</p></td>
<td rowspan="2"><p>RDS スループット（送信）</p>
<p>スループットが0の場合、異常と判断</p>
</td>
<td rowspan="2"><p>aws.rds.network_transmit_throughput</p></td>
<td rowspan="2"><p>スループット=0</p></td>
<td rowspan="2"><p>スループット=2</p></td>
<td rowspan="2"><p>スループット=2以上</p></td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="2"><p>[CARNAS &amp;g] RDS スループット（受信）</p></td>
<td rowspan="2"><p>RDS スループット（受信）</p>
<p>スループットが0の場合、異常と判断</p>
</td>
<td rowspan="2"><p>aws.rds.network_receive_throughput</p></td>
<td rowspan="2"><p>スループット=0</p></td>
<td rowspan="2"><p>スループット=2</p></td>
<td rowspan="2"><p>スループット=2以上</p></td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="2"><p>[CARNAS &amp;g] ECS CPUユニット数（サンプルカウント）</p></td>
<td rowspan="2"><p>ECS CPUユニット数</p>
<p>ユニット数が0の場合、異常と判断</p>
</td>
<td rowspan="2"><p>aws.ecs.cpuutilization.samplecount</p></td>
<td rowspan="2"><p>カウント数=0</p></td>
<td rowspan="2"><p>カウント数=1</p></td>
<td rowspan="2"><p>カウント数=1以上</p></td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="2"><p>[CARNAS &amp;g] ECS CPUユニット数（サンプルカウント）（サービス別）</p></td>
<td rowspan="2"><p>ECS CPUユニット数（サービス別）</p>
<p>ユニット数が0の場合、異常と判断</p>
</td>
<td rowspan="2"><p>aws.ecs.cpuutilization.samplecount</p></td>
<td rowspan="2"><p>カウント数=0</p></td>
<td rowspan="2"><p>カウント数=1</p></td>
<td rowspan="2"><p>カウント数=1以上</p></td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="2"><p>バッチ処理</p></td>
<td rowspan="2"><p>[CARNAS &amp;g] lambdaエラー率</p></td>
<td rowspan="2"><p>lambdaエラー率</p>
<p>lambdaエラー率上昇で異常と判断</p>
</td>
<td rowspan="2"><p>aws.lambda.errors</p>
<p>aws.lambda.invocations</p>
</td>
<td rowspan="2"><p>エラー率=80</p></td>
<td rowspan="2"><p>エラー率=70</p></td>
<td rowspan="2"><p>エラー率=0</p></td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="3"><p>スケジュール処理の失敗</p></td>
<td><p>[CARNAS &amp;g] スケジュール処理失敗回数</p></td>
<td><p>ルール呼出し失敗回数</p></td>
<td><p>aws.events.failed_invocations</p></td>
<td><p>回数&gt;2</p></td>
<td><p>回数&gt;1</p></td>
<td><p>回数&lt;0</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p>[CARNAS &amp;g] スケジュール処理失敗率</p></td>
<td rowspan="2"><p>ルール呼出し失敗率</p></td>
<td rowspan="2"><p>aws.events.failed_invocations</p>
<p>aws.events.invocations</p>
</td>
<td rowspan="2"><p>失敗率=10</p></td>
<td rowspan="2"><p>失敗率=5</p></td>
<td rowspan="2"><p>失敗率=0</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="10"><p>データーベース負荷</p></td>
<td rowspan="2"><p>[CARNAS &amp;g] RDS CPU使用率</p></td>
<td rowspan="2"><p>RDS CPU使用率</p>
<p>使用率上昇で異常と判断</p>
</td>
<td rowspan="2"><p>aws.rds.cpuutilization</p></td>
<td rowspan="2"><p>負荷70％以上</p></td>
<td rowspan="2"><p>負荷50％以上</p></td>
<td rowspan="2"><p>負荷20％以下</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="3"><p>[CARNAS &amp;g] RDS CPU使用率（business）</p></td>
<td rowspan="3"><p>RDS CPU使用率</p>
<p>対象  business</p>
<p>使用率上昇で異常と判断</p>
</td>
<td rowspan="3"><p>aws.rds.cpuutilization</p></td>
<td rowspan="3"><p>負荷70％以上</p></td>
<td rowspan="3"><p>負荷50％以上</p></td>
<td rowspan="3"><p>負荷20％以下</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="3"><p>[CARNAS &amp;g] RDS CPU使用率（core）</p></td>
<td rowspan="3"><p>RDS CPU使用率</p>
<p>対象  core</p>
<p>使用率上昇で異常と判断</p>
</td>
<td rowspan="3"><p>aws.rds.cpuutilization</p></td>
<td rowspan="3"><p>負荷70％以上</p></td>
<td rowspan="3"><p>負荷50％以上</p></td>
<td rowspan="3"><p>負荷20％以下</p></td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="2"><p>[CARNAS &amp;g] RDS MAX CPU使用率</p></td>
<td rowspan="2"><p>RDS 最大CPU使用率</p>
<p>使用率上昇で異常と判断</p>
</td>
<td rowspan="2"><p>aws.ecs.cpuutilization.maximum</p></td>
<td rowspan="2"><p>負荷70％以上</p></td>
<td rowspan="2"><p>負荷50％以上</p></td>
<td rowspan="2"><p>負荷20％以下</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="8"><p>ElasticSearchの負荷</p></td>
<td><p>[CARNAS &amp;g] elasticsearch CPU使用率</p></td>
<td><p>es cpu使用率</p></td>
<td><p>aws.es.cpuutilization</p></td>
<td><p>負荷70％以上</p></td>
<td><p>負荷50％以上</p></td>
<td><p>負荷20％以下</p></td>
</tr>
<tr class="row-even"><td><p>[CARNAS &amp;g] elasticsearch CPU使用率（nodeid別）</p></td>
<td><p>es cpu使用率（nodeid別）</p></td>
<td><p>aws.es.cpuutilization</p></td>
<td><p>負荷70％以上</p></td>
<td><p>負荷50％以上</p></td>
<td><p>負荷20％以下</p></td>
</tr>
<tr class="row-odd"><td><p>[CARNAS &amp;g] elasticsearch メモリ用使率</p></td>
<td><p>es mem使用率</p></td>
<td><p>aws.es.sys_memory_utilization</p></td>
<td><p>負荷70％以上</p></td>
<td><p>負荷50％以上</p></td>
<td><p>負荷20％以下</p></td>
</tr>
<tr class="row-even"><td><p>[CARNAS &amp;g] elasticsearch メモリ用使率（nodeid別）</p></td>
<td><p>es mem使用率（nodeid別）</p></td>
<td><p>aws.es.sys_memory_utilization</p></td>
<td><p>負荷70％以上</p></td>
<td><p>負荷50％以上</p></td>
<td><p>負荷20％以下</p></td>
</tr>
<tr class="row-odd"><td><p>[CARNAS &amp;g] elasticsearch 検索時間</p></td>
<td><p>es 検索時間</p></td>
<td><p>aws.es.search_latency</p></td>
<td><p>5ミリ秒以上</p></td>
<td><p>2ミリ秒以上</p></td>
<td><p>1ミリ秒以下</p></td>
</tr>
<tr class="row-even"><td><p>[CARNAS &amp;g] elasticsearch Index作成時間</p></td>
<td><p>es index作成時間</p></td>
<td><p>aws.es.indexing_latency</p></td>
<td><p>5ミリ秒以上</p></td>
<td><p>2ミリ秒以上</p></td>
<td><p>1ミリ秒以下</p></td>
</tr>
<tr class="row-odd"><td><p>[CARNAS &amp;g] elasticsearch Job実行状況</p></td>
<td><p>es jobスケジュール通りの実行</p></td>
<td><p>aws.es.alerting_nodes_on_schedule</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>[CARNAS &amp;g] elasticsearch 異常検出プラグイン</p></td>
<td><p>es 異常検出プラグインが正しく動作しているか</p></td>
<td><p>aws.es.adplugin_unhealthy</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td rowspan="5"><p>外形監視レスポンス時間</p></td>
<td><p>[CARNAS &amp;g] 外形監視  レスポンスタイム  bff</p></td>
<td><p>bff</p></td>
<td><p>synthetics.http.response.time</p></td>
<td><p>300ミリ秒以上</p></td>
<td><p>200ミリ秒以上</p></td>
<td><p>100ミリ秒以下</p></td>
</tr>
<tr class="row-even"><td><p>[CARNAS &amp;g] 外形監視  レスポンスタイム  bff ex</p></td>
<td><p>bff ex</p></td>
<td><p>synthetics.http.response.time</p></td>
<td><p>300ミリ秒以上</p></td>
<td><p>200ミリ秒以上</p></td>
<td><p>100ミリ秒以下</p></td>
</tr>
<tr class="row-odd"><td><p>[CARNAS &amp;g] 外形監視  レスポンスタイム  budiness</p></td>
<td><p>business</p></td>
<td><p>synthetics.http.response.time</p></td>
<td><p>300ミリ秒以上</p></td>
<td><p>200ミリ秒以上</p></td>
<td><p>100ミリ秒以下</p></td>
</tr>
<tr class="row-even"><td><p>[CARNAS &amp;g] 外形監視  レスポンスタイム  core</p></td>
<td><p>core</p></td>
<td><p>synthetics.http.response.time</p></td>
<td><p>300ミリ秒以上</p></td>
<td><p>200ミリ秒以上</p></td>
<td><p>100ミリ秒以下</p></td>
</tr>
<tr class="row-odd"><td><p>[CARNAS &amp;g] 外形監視  レスポンスタイム  pub</p></td>
<td><p>pub</p></td>
<td><p>synthetics.http.response.time</p></td>
<td><p>300ミリ秒以上</p></td>
<td><p>200ミリ秒以上</p></td>
<td><p>100ミリ秒以下</p></td>
</tr>
</tbody>
</table>
<p>3.8 外形監視による異常検知</p>
<blockquote>
<div><p>※当面はDatadogは使わずCloudWatchで行う</p>
</div></blockquote>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td rowspan="2"><p>監視対象</p></td>
<td rowspan="2"><p>Datadog</p></td>
<td rowspan="2"><p>Test URL</p>
<p>後で本番URLに修正</p>
</td>
<td rowspan="2"><p>指定URLからの応答時間（response time）</p></td>
<td rowspan="2"><p>指定URLからのレスポンスコード（status code）</p></td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td><p>bffの外形監視</p></td>
<td><p>Synthetic Test</p></td>
<td><p><a class="reference external" href="https://tnt003.testv3.md.carnas.jp/api/test">https://tnt003.testv3.md.carnas.jp/api/test</a></p></td>
<td><p>including DNS is less than　3000ms</p></td>
<td><p>200</p></td>
</tr>
<tr class="row-even"><td><p>bff-exの外形監視</p></td>
<td><p>Synthetic Test</p></td>
<td><p><a class="reference external" href="https://testv3.md.carnas.jp/bff-ex/test">https://testv3.md.carnas.jp/bff-ex/test</a></p></td>
<td></td>
<td><p>200</p></td>
</tr>
<tr class="row-odd"><td><p>businessサービスの外形監視</p></td>
<td><p>Synthetic Test</p></td>
<td><p><a class="reference external" href="https://tnt003.testv3.md.carnas.jp/api/contracts/1">https://tnt003.testv3.md.carnas.jp/api/contracts/1</a></p></td>
<td></td>
<td><p>200</p></td>
</tr>
<tr class="row-even"><td><p>coreサービスの外形監視</p></td>
<td><p>Synthetic Test</p></td>
<td><p><a class="reference external" href="https://tnt003.testv3.md.carnas.jp/api/common/search-institution">https://tnt003.testv3.md.carnas.jp/api/common/search-institution</a></p></td>
<td></td>
<td><p>200</p></td>
</tr>
<tr class="row-odd"><td><p>pubサービスの外形監視</p></td>
<td><p>Synthetic Test</p></td>
<td><p><a class="reference external" href="https://tnt003.testv3.md.carnas.jp/api/common/sysdate">https://tnt003.testv3.md.carnas.jp/api/common/sysdate</a></p></td>
<td></td>
<td><p>200</p></td>
</tr>
<tr class="row-even"><td><p>engine-file 帳票エンジンサービスの外形監視</p></td>
<td><p>APMログで対応</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>engine-pdf 帳票エンジンサービスの外形監視</p></td>
<td><p>APMログで対応</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>engine-file-billing帳票エンジンサービスの外形監視</p></td>
<td><p>APMログで対応</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>engine-pdf-billing帳票エンジンサービスの外形監視</p></td>
<td><p>APMログで対応</p></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>参照1: <a class="reference external" href="https://docs.google.com/spreadsheets/d/1QsHn-ldwiiuu_T6DmRfC99nMFtL_uNZZSWwKmYwc-EU/edit#gid=1739388766&amp;range=A51">CARNAS_&amp;g_testv3_341408569635_設定書 - Google スプレッドシート</a></p>
<blockquote>
<div><p>外形監視の結果をもとにした障害対応フローは以下を参照</p>
<blockquote>
<div><p><a class="reference external" href="https://app.diagrams.net/#G1aBIjmog3CHoeo5RUOIKx7A5c5cYafaun">https://app.diagrams.net/#G1aBIjmog3CHoeo5RUOIKx7A5c5cYafaun</a></p>
</div></blockquote>
</div></blockquote>
<p>3.9 異常検知時の通知</p>
<ul class="simple">
<li><p>異常検知時は監視システムから自動通知（SNS:Slack、メール）を行う。※当面はCloudWatchからメールでの自動通知のみとする。</p></li>
<li><p>運用担当は通知内容からレベルの識別を行い「アラート」「ワーニング」と判断された場合は、<a class="reference external" href="https://carnasproj.atlassian.net/jira/software/c/projects/CSPT/boards/71">JIRA「CARNAS_SUPPORT」プロジェクト</a> に記録する。</p></li>
</ul>
<ul class="simple">
<li><p>記録項目は、 <a class="reference external" href="https://docs.google.com/spreadsheets/d/1GzengPrB6el5Ds5u1iHkaEDZZGRFr9iefd4F3TjdiYM/edit#gid=1343823404">パイロット動作検証、利用期間中の対応フロー</a> （「Jiraチケット説明」シート）を参照。</p></li>
</ul>
<ul class="simple">
<li><p>障害復旧作業については、「インシデント管理」、恒久対策については「問題管理」で対応する。</p></li>
</ul>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td rowspan="2"><p>レベル</p></td>
<td rowspan="2"><p>定義</p></td>
<td rowspan="2"><p>通知先/通知手段</p>
<p>運用担当</p>
</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"><td rowspan="3"><p>アラート</p></td>
<td rowspan="3"><p>Datadogモニタリング設定にて「アラートレベルの閾値」を超えた時に通知</p>
<p>サービス停止/継続</p>
<p>　即時対応が必要なイベント</p>
</td>
<td rowspan="3"><p>1.SNS:Slack</p>
<p>メール（自動通知）</p>
</td>
</tr>
<tr class="row-even"></tr>
<tr class="row-odd"></tr>
<tr class="row-even"><td rowspan="3"><p>ワーニング</p></td>
<td rowspan="3"><p>Datadogモニタリング設定にて「ワーニングレベルの閾値」を超えた時に通知</p>
<p>サービス継続</p>
<p>　アラートレベルに達する可能性があるイベント</p>
</td>
<td rowspan="3"><p>1.SNS:Slack</p>
<p>メール（自動通知）</p>
</td>
</tr>
<tr class="row-odd"></tr>
<tr class="row-even"></tr>
</tbody>
</table>
<ul class="simple">
<li><p>メール（自動通知）は、Datadog/CloudWatchから送信されるアラート通知メールであり、送信内容は一律のものとする。各所でメールを受信するMLを作成し、所定のMLへ向けて送信設定を行う。</p></li>
</ul>
<p>3.10 メール・Slack（自動通知）のフォーマット</p>
<blockquote>
<div><p>※当面は、自動通知ではなく、目視での対応とする。</p>
</div></blockquote>
<p>3.11 監視実施時間</p>
<blockquote>
<div><p>監視実施時間は「2.4.2 各担当の対応時間」を参照。但し、AWS基盤のメンテナンス等により停止する場合がある。監視停止については、事前に周知する。</p>
</div></blockquote>
</section>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="02-00-00.html"
       title="前の章へ">← 02.サービス運用方針</a>
  </li>
  <li class="next">
    <a href="04-00-00.html"
       title="次の章へ">04.サービスデスク →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2023, NJC.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.2.6 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a> 0.8.0.
</div>
            </div>
          </div>
      </page>
    </div></div>
    
    
  </body>
</html>